<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문의글 수정</title>
    <link rel="stylesheet" href="../resource/css/boardUpdate.css">
    <!-- <script src="https://cdn.ckeditor.com/ckeditor5/31.1.0/classic/ckeditor.js"></script> -->
    <script src="../resource/lib/ckeditor5/build/ckeditor.js"></script>
    <script src="../js/boardClass.js"></script>
    <script src="../js/boardManagerClass.js"></script>

    <script>



    </script>
</head>

<body>
    <div id="container">
        <div id="head">
            <div id="header">
                <h1 class="logo">
                    <a href="./main.html">THE SHILLA HOTELS & RESORTS</a>
                </h1>
                <span class="loginArea">
                    <a href="./loginSignup.html">로그인</a>
                </span>

                <!-- 예약확인 토글 -->
                <div class="resrve-confirm">
                    <!-- on 일때 background 변경 -->
                    <div class="resrve-confirm-box">
                        <!-- preventDefault 줘야함 -->
                        <a class="resrve-btn" href="#">예약확인</a>
                        <!-- 기본 display: none; -->
                        <ul class="list">
                            <li>
                                <ul class="list-style">
                                    <li class="style1">
                                        <a href="./loginSignup.html">
                                            <span>객실</span>
                                        </a>
                                    </li>
                                    <li class="style1">
                                        <a href="./loginSignup.html">
                                            <span>다이닝</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 호텔찾기 -->
                <div class="hotel-box">
                    <a class="hotel-find-btn" href="#;"></a>
                    <!-- 모달창 -->
                    <div class="fh-modal">
                        <!-- 모달 head -->
                        <div class="fhm-head">
                            <ul class="fhm-tab-box">
                                <li class="fhm-tab1 on">
                                    <a class="fhm-tab1-btn" href="#">
                                        <span>권역별</span>
                                    </a>
                                </li>
                                <li class="fhm-tab2">
                                    <a class="fhm-tab2-btn" href="#">
                                        <span>브랜드별</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- 권역별 -->
                        <div class="fhm-body1">
                            <div class="fhm-region">
                                <ul>
                                    <li class="fhm-domestic"><img src="../resource/img/main/main_tab2_tit1.gif"
                                            alt="국내"></li>
                                    <!-- 서울 강북 -->
                                    <li>
                                        <span class="fhm-location">
                                            <img src="../resource/img/main/main_tab2_stit1.gif" alt="">
                                        </span>
                                        <ul class="fhm-select-wrap">
                                            <li class="fhm-select-box">
                                                <span>서울신라호텔</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 광화문</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 마포</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 서대문</span>
                                            </li>
                                        </ul>
                                    </li>
                                    <!-- 서울 강남 -->
                                    <li>
                                        <span class="fhm-location">
                                            <img src="../resource/img/main/main_tab2_stit2.gif" alt="">
                                        </span>
                                        <ul class="fhm-select-wrap">
                                            <li class="fhm-select-box">
                                                <span>신라스테이 역삼</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 서초</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 구로</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 삼성</span>
                                            </li>
                                        </ul>
                                    </li>
                                    <!-- 전국 -->
                                    <li>
                                        <span class="fhm-location">
                                            <img src="../resource/img/main/main_tab2_stit3.gif" alt="">
                                        </span>
                                        <ul class="fhm-select-wrap">
                                            <li class="fhm-select-box">
                                                <span>제주신라호텔</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 동탄</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 천안</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 울산</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 해운대</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 서부산</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 여수</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 제주</span>
                                            </li>
                                            <li class="fhm-select-box">
                                                <span>신라스테이 플러스 이호테우</span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <!-- 해외 -->
                                <ul class="fhm-overseas">
                                    <li class="fhm-domestic"><img src="../resource/img/main/main_tab2_tit2.gif"
                                            alt="국내"></li>
                                    <li>
                                        <span class="fhm-location">
                                            <img src="../resource/img/main/main_tab2_stit4.gif" alt="">
                                        </span>
                                        <ul class="fhm-select-wrap">
                                            <li class="fhm-select-box">
                                                <span>신라모노그램 다낭</span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- 브랜드별 -->
                        <div class="fhm-body2">
                            <div class="fhm-brand">
                                <!-- THESHILLA -->
                                <ul>
                                    <li class="fhm-brand-logo">
                                        <span>
                                            <img src="../resource/img/main/main_tab1_tit1.gif" alt="국내">
                                        </span>
                                    </li>
                                    <li>
                                        <ul class="fhm-select-wrap2">
                                            <li class="fhm-select-box2">
                                                <span>서울신라호텔</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>제주신라호텔</span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <!-- SHILLA MONOGRAM -->
                                <ul>
                                    <li class="fhm-brand-logo">
                                        <span>
                                            <img src="../resource/img/main/main_tab1_tit2.gif" alt="국내">
                                        </span>
                                    </li>
                                    <li>
                                        <ul class="fhm-select-wrap2">
                                            <li class="fhm-select-box2">
                                                <span>신라모노그램 다낭</span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <!-- SHILLA STAY -->
                                <ul>
                                    <li class="fhm-brand-logo">
                                        <span>
                                            <img src="../resource/img/main/main_tab1_tit3.gif" alt="국내">
                                        </span>
                                    </li>
                                    <li>
                                        <ul class="fhm-select-wrap2">
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 광화문</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 마포</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 서대문</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 역삼</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 서초</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 구로</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 삼성</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 동탄</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 천안</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 울산</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 해운대</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 서부산</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 여수</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 제주</span>
                                            </li>
                                            <li class="fhm-select-box2">
                                                <span>신라스테이 플러스 이호테우</span>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- 닫기 버튼 -->
                        <a class="fhm-close" href="#">닫기</a>
                    </div>
                    <!-- 모달 배경 -->
                    <div class="fhm-screen"></div>
                </div>

                <!-- 예약 -->
                <div class="rsv-box">
                    <a class="rsv-btn" href="javascript:void(0);"></a>
                    <!-- 예약 모달창 -->
                    <div class="rsv-modal">
                        <!-- 모달 head -->
                        <div class="rsv-head">
                            <ul class="rsv-tab">
                                <li>
                                    <a>
                                        <span></span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <!-- 모달 content -->
                        <div class="rsv-content">
                            <div class="rsv-list">
                                <ul>
                                    <li class="rsv-hotel-link">
                                        <a href="javascript:void(0)">
                                            객실 예약
                                        </a>
                                    </li>
                                    <li class="rsv-dining-link">
                                        <a href="javascript:void(0)">
                                            다이닝 예약
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <!-- 닫기 버튼 -->
                        <a class="rsv-close" href="#">닫기</a>
                    </div>
                    <!-- 모달 배경 -->
                    <div class="rsv-screen"></div>
                </div>

                <!-- 네비게이션바 -->
                <div class="nav-bar">
                    <ul>
                        <li>
                            <span class="nav1">
                                <a href="#">호텔신라 소개</a>
                            </span>
                        </li>
                        <li>
                            <span class="nav2">
                                <a href="./boardList.html">고객문의</a>
                            </span>
                        </li>
                        <li>
                            <span class="nav3">
                                <a href="#">신라리워즈</a>
                            </span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="content">
            <div>
                <h2>문의 수정</h2>
            </div>
            <div>
                <form id="form">
                    <div>
                        <div>
                            <label for="title">제목</label>
                        </div>
                        <div>
                            <input type="text" id="title">
                        </div>
                    </div>
                    <div>
                        <div>
                            <label for="content">상세내용</label>
                        </div>
                        <div>
                            <textarea id="content" name="content"></textarea>
                        </div>
                    </div>
                    <div class="btn-box">
                        <button>수정완료</button>
                        <button type="button" id="back">뒤로가기</button>
                    </div>
                </form>
                <div style="display: none;" id="imgBlock">
                    <label class="ck ck-button ck-off ck-file-dialog-button" for="imgBtn">
                        <svg class="ck ck-icon ck-reset_all-excluded ck-icon_inherit-color ck-button__icon">
                            <path
                                d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z">
                            </path>
                            <path
                                d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z">

                            </path>
                            <path
                                d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z">
                            </path>
                        </svg>
                    </label>

                    <input type="file" id="imgBtn" accept=".gif,.jpg,.png">
                </div>
            </div>
        </div>
        <div class="footer">
            <div>
                <img src="../resource/img/footerlogo.gif">
            </div>
            <div>
                <div>
                    <div>
                        <img src="../resource/img/mono.png">
                    </div>
                    <div>
                        <img src="../resource/img/stay.png">
                    </div>
                    <div>
                        <img src="../resource/img/shilla.png">
                    </div>
                </div>
                <div>
                    <div>
                        <img src="../resource/img/tel.gif" alt="">
                    </div>
                    <div>
                        <img src="../resource/img/intro.png" alt="">
                    </div>
                    <div>
                        <img src="../resource/img/sns.png" alt="">
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

<script src="../js/boardUpdate.js"></script>
<script>

    const _form = document.querySelector("#form");

    function submitHandler() {
        let nickname = sessionStorage.getItem("currentUser");
        const boardIndex = parseInt(new URLSearchParams(location.search).get("index"));

        const title = document.querySelector("#title").value;
        const content = editor.getData();
        if (!nullStringCheck(title, "제목") || !nullStringCheck(editor.getData(), "내용"))
            return;

        const boardList = new BoardManager();
        boardList.updateBoard(boardIndex, title, content);
        location.href = `boardDetail.html?index=${boardIndex}`;

    }
    _form.onsubmit = function (e) {
        e.preventDefault();
        submitHandler()
    }

    async function main() {
        window.editor = await ClassicEditor.create(document.querySelector("#content"));
        const list = new BoardManager();
        const boardIndex = new URLSearchParams(location.search).get("index");
        const board = list.getBoardList()[boardIndex];
        title.value = board.getTitle();
        editor.setData(board.getContent())
        imgBtnChange();
        appendImg(editor)
    }
    // 에디터기능 대체하는 이미지 버튼으로 변경하는 함수
    async function imgBtnChange() {
        const ckContent = document.querySelector(".ck-file-dialog-button");
        const _btn = document.querySelector("#imgBlock > label")
        ckContent.replaceWith(_btn)
    }

    //이미지를 에디터에 추가하는 함수 
    function appendImg(editor) {
        const _div = document.createElement("div");
        const _input = document.querySelector("#imgBtn");
        const ckContent = document.querySelector(".ck-content")
        _input.onchange = (e) => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = async (test) => {
                const _div = document.createElement("div");
                const _img = document.createElement("img");
                _img.setAttribute("src", test.target.result);
                _div.append(_img)
                editor.setData(ckContent.innerHTML + _div.innerHTML)
            }
            reader.readAsDataURL(file)
        }
    }
    function nullStringCheck(el, type) {
        if (el === '') {
            alert(`${type}을 입력해주세요.`);
            return false;
        }
        return true;
    }

    main();
</script>
<script src="../js/loginCheck.js"></script>
<script src="../js/header.js"></script>

</html>